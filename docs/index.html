<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Streamlining use of the AllofUs Researcher Workbench notebooks and increasing interoperability with the OHDSI toolstack.">
<title>Tools for the AllofUs Researcher Workbench  • allofus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Tools for the AllofUs Researcher Workbench ">
<meta property="og:description" content="Streamlining use of the AllofUs Researcher Workbench notebooks and increasing interoperability with the OHDSI toolstack.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-black"><div class="container">
    <div style="height:40px;display:inline;margin:0 10px;"><a href="https://ohdsi.northeastern.edu/" class="external-link"><img src="https://roux-ohdsi.github.io/allofus/articles/logo.png" style="width:auto;height:100%;"></a></div>
    <a class="navbar-brand me-2" href="index.html">allofus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/allofus.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/workspace.html">Managing files on the workbench</a>
    <a class="dropdown-item" href="articles/data.html">Extracting All of Us survey and EHR data</a>
    <a class="dropdown-item" href="articles/atlas.html">Using ATLAS to create a cohort</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Codebooks</h6>
    <a class="dropdown-item" href="articles/web_only/searchable_codebook.html">All of Us Surveys</a>
    <a class="dropdown-item" href="articles/web_only/health_codebook.html">Health History Surveys</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/roux-ohdsi/allofus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="allofus-r-package">
<code>allofus</code> R Package<a class="anchor" aria-label="anchor" href="#allofus-r-package"></a>
</h1></div>
<p>The goal of the <code>allofus</code> R package is to streamline the use of R within the <a href="https://www.researchallofus.org/data-tools/workbench/" class="external-link">AllofUs Researcher Workbench</a>.</p>
<p><em>The <code>allofus</code> R package is a not affiliated with or endorsed by the All of Us Research Program.</em></p>
<p>The <code>allofus</code> package helps researchers query the database and build transparent and reproducible analysed pipeline. The package allows researchers to easily use other database packages, such as <code>dbplyr</code> and <code>DBI</code>, with the AllofUs database. The package also includes functions to help researchers manage storage in their workspace and bucket, as well as take advantage of tools developed for <a href="https://www.researchallofus.org/faq/what-is-omop/" class="external-link">OMOP CDM</a> data.</p>
<!-- badges: start -->

<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"roux-ohdsi/allofus"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://roux-ohdsi.github.io/allofus/" class="external-link">allofus</a></span><span class="op">)</span></span></code></pre></div>
<p>Use <code><a href="reference/aou_connect.html">aou_connect()</a></code> to establish a database connection.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aou_connect.html">aou_connect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This connection object is a <a href="https://dbi.r-dbi.org/" class="external-link">DBI</a> connection object, so you can use it with other packages that use DBI connections, such as <a href="https://dbplyr.tidyverse.org/" class="external-link">dbplyr</a>.</p>
<p>For example, you can use <code>tbl()</code> from <a href="https://dplyr.tidyverse.org/" class="external-link">dplyr</a> to access the person table from the All of Us database:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">person</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"person"</span><span class="op">)</span></span></code></pre></div>
<p>You can then use <code>dplyr</code> functions on the table:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">person</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gender_concept_id</span> <span class="op">==</span> <span class="fl">8507</span><span class="op">)</span></span></code></pre></div>
<p>and join the table to other tables in the database:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">person</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"observation"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"person_id"</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="reference/aou_join.html">aou_join()</a></code> function is a wrapper around the <code>dplyr</code> join functions that allows you to join tables more easily:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">person</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/aou_join.html">aou_join</a></span><span class="op">(</span><span class="st">"observation"</span>, type <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p>See <code>vignette("sql", package = "allofus")</code> for more examples.</p>
<!-- ## Example -->
<!-- Suppose we want to create a cohort of All of Us participants who have experienced a stroke. There are a couple of ways we could go about this. -->
<!-- ### Using the observation table -->
<!-- The following code would start a query for the first survey date for the AllofUs survey "The Basics" (sometimes, but rarely, participants completed this survey over multiple dates). -->
<!-- *While the ds_survey table is conveniently organized, it does not include the "skip" response for some surveys, so we don't recommend using it unless you're sure all potential responses have been recorded in the table. It's safest to use the observation table. You can see a detailed description of the survey ETL here: https://support.researchallofus.org/hc/en-us/articles/6085114880148.* -->
<!-- ```{r, eval = FALSE} -->
<!-- library(tidyverse) -->
<!-- survey_dates = tbl(con, "ds_survey") %>% -->
<!--   filter(survey == "The Basics") %>% -->
<!--   group_by(person_id) %>% -->
<!--   filter(survey_datetime == min(survey_datetime)) %>% -->
<!--   distinct(person_id, survey_datetime) -->
<!-- ``` -->
<!-- And this code would start with the all of us specific person table and join that to the survey dates table to incorporate information about demographics. -->
<!-- ```{r, eval = FALSE} -->
<!-- demo <- tbl(con, "cb_search_person") %>% -->
<!--   filter(age_at_consent >= 40 & age_at_consent <= 120, -->
<!--          has_ehr_data == 1) %>% -->
<!--   distinct(person_id, sex_at_birth, dob)  %>% -->
<!--   inner_join(survey_dates, by = "person_id") %>% -->
<!--   select(person_id, sex_at_birth, dob, survey_datetime) -->
<!-- ``` -->
<!-- We could leave this as a query, or we could pull the data into our local session: -->
<!-- ```{r, eval = FALSE} -->
<!-- demo_collected <- demo %>% collect() -->
<!-- ``` -->
</div>
<div class="section level2">
<h2 id="bugs">Bugs<a class="anchor" aria-label="anchor" href="#bugs"></a>
</h2>
<p>Please leave us comments, requests, and report bugs using the “Issues” tab on github located here: <a href="https://github.com/roux-ohdsi/allofus/issues" class="external-link uri">https://github.com/roux-ohdsi/allofus/issues</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/roux-ohdsi/allofus/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/roux-ohdsi/allofus/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing allofus</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Louisa Smith <br><small class="roles"> Author, copyright holder </small>  </li>
<li>Rob Cavanaugh <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/roux-ohdsi/allofus/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/roux-ohdsi/allofus/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=allofus" class="external-link"><img src="https://www.r-pkg.org/badges/version/allofus?color=green"></a></li>
<li><a href="https://cran.r-project.org/package=allofus" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/allofus?color=green"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Louisa Smith, Rob Cavanaugh.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
